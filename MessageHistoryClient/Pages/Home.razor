@page "/"
@using MessageHistoryClient.Services
@using MessageHistoryClient.Models
@inject MessageService MessageService
@implements IDisposable

<h3>История сообщений за последние 10 минут</h3>

@if (messages == null)
{
    <p>Загрузка...</p>
}
else if (!messages.Any())
{
    <p>Сообщений нет за последние 10 минут.</p>
}
else
{
    <ul class="list-group">
        @foreach (var message in messages)
        {
            <li class="list-group-item">
                <strong>@message.SequenceNumber:</strong> @message.Text <br />
                <small>@message.Timestamp.ToLocalTime()</small>
            </li>
        }
    </ul>
}

@code {
    private List<Message> messages;

    protected override async Task OnInitializedAsync()
    {
        await LoadMessagesAsync();
    }

    private async Task LoadMessagesAsync()
    {
        messages = await MessageService.GetMessagesAsync();
        StateHasChanged();
    }

    public void Dispose()
    {
        // Возможно, потребуется очистка ресурсов
    }
}

